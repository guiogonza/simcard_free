<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Listado de SIMs ‚Äì Freeeway</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background: #f7fafc; }
    .card { border-radius: 12px; }
    .table thead th { border-bottom-color: #b6d4fe; color:#0d6efd; }
    .table tbody td { border-top-color: #e9ecef; }
    .badge { font-size: 0.85rem; }
    .status-online { background: #d1e7dd; color:#0f5132; border:1px solid #badbcc; }
    .status-offline { background: #e2e3e5; color:#41464b; border:1px solid #d3d6d8; }
    .status-error { background: #f8d7da; color:#842029; border:1px solid #f5c2c7; }
    .status-other { background: #cff4fc; color:#055160; border:1px solid #b6effb; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; }
    .hint { color:#0d6efd; font-weight: 500; }
    .input-page { width: 90px; }
    .cfg-badge { background:#e7f1ff; border:1px solid #cfe2ff; color:#0b5ed7; }
    th.sortable { cursor: pointer; user-select: none; }
    th.sortable:hover { background-color: #e7f1ff !important; }
    th.sortable::after { content: " "; font-size: 0.8em; color: #999; margin-left: 5px; }
    th.sortable.asc::after { content: " "; color: #0d6efd; }
    th.sortable.desc::after { content: " "; color: #0d6efd; }
    th.sortable { cursor: pointer; user-select: none; }
    th.sortable:hover { background-color: #e7f1ff !important; }
    th.sortable::after { content: " "; font-size: 0.8em; color: #999; margin-left: 5px; }
    th.sortable.asc::after { content: " "; color: #0d6efd; }
    th.sortable.desc::after { content: " "; color: #0d6efd; }
    th.sortable { cursor: pointer; user-select: none; }
    th.sortable:hover { background-color: #e7f1ff !important; }
    th.sortable::after { content: " "; font-size: 0.8em; color: #999; margin-left: 5px; }
    th.sortable.asc::after { content: " "; color: #0d6efd; }
    th.sortable.desc::after { content: " "; color: #0d6efd; }
  </style>
</head>
<body>
  <div class="container py-4">

    <!-- Banner de √∫ltima actualizaci√≥n -->
    <div id="updateBanner" class="alert alert-info d-flex align-items-center justify-content-between mb-3 shadow-sm" role="alert" style="border-left: 5px solid #0d6efd;">
      <div>
        <i class="bi bi-clock-history"></i>
        <strong>üïê √öltima actualizaci√≥n completa:</strong> <span id="bannerLastRefresh" class="fw-bold">Calculando...</span>
        <span class="text-muted ms-3">| Pr√≥xima actualizaci√≥n autom√°tica:</span> <span id="bannerNextPlanned" class="fw-bold">‚Äî</span>
      </div>
      <div>
        <span id="bannerAutoLabel" class="badge bg-success">‚ü≥ Auto cada 1h</span>
      </div>
    </div>

    <header class="mb-4 d-flex justify-content-between align-items-center">
      <div>
        <h1 class="h4 mb-1 text-primary">Listado de SIM Cards Kontigo</h1>
      </div>
      <div><a href="/" class="btn btn-outline-primary">Volver</a></div>
    </header>

    <div class="card shadow-sm mb-3">
      <div class="card-body">
        <div class="row g-3 align-items-center">
          <div class="col-lg-4">
            <label class="form-label">Filtro (ICCID / IMSI / MSISDN / Pa√≠s / Operador)</label>
            <input id="filter" class="form-control" placeholder="Ej: 8943..., 732, Claro, Colombia">
          </div>

          <div class="col-lg-2">
            <label for="pageSize" class="form-label">Ver por p√°gina</label>
            <select id="pageSize" class="form-select">
              <option value="50" selected>50</option>
              <option value="100">100</option>
              <option value="500">500</option>
            </select>
          </div>

          <div class="col-lg-3">
            <label class="form-label">Acciones</label>
            <button id="btnRefresh" class="btn btn-primary w-100">Actualizar ahora</button>
          </div>

          <div class="col-lg-3">
            <label class="form-label d-block">Progreso (worker)</label>
            <div class="progress" role="progressbar" aria-label="Progreso" aria-valuemin="0" aria-valuemax="100">
              <div id="bar" class="progress-bar bg-info" style="width: 0%;">0%</div>
            </div>
            <div class="small text-muted mt-1">
              <span id="progressText">Pendiente</span>
            </div>
            <div class="mt-2 small">
              <span>√öltima ejecuci√≥n: <strong id="lastRefresh">‚Äî</strong></span><br>
              <span>Pr√≥xima: <strong id="nextPlanned">‚Äî</strong></span>
            </div>
            <div class="mt-2 small">

            </div>
          </div>
        </div>

        <div class="mt-3">

        </div>

        <div class="d-flex align-items-center gap-2 mt-3 flex-wrap">
          <button id="btnFirst" class="btn btn-outline-secondary btn-sm">Primera</button>
          <button id="btnPrev" class="btn btn-outline-secondary btn-sm">Anterior</button>
          <button id="btnNext" class="btn btn-outline-secondary btn-sm">Siguiente</button>
          <button id="btnLast" class="btn btn-outline-secondary btn-sm">√öltima</button>
          <span class="ms-2 small" id="pageInfo">P√°gina 1 de 1 ‚Äî mostrando 0‚Äì0 de 0</span>

          <div class="ms-auto d-flex align-items-center gap-2">
            <label for="gotoInput" class="form-label mb-0">Ir a:</label>
            <input id="gotoInput" type="number" min="1" class="form-control input-page" placeholder="N¬∞ p√°g.">
            <button id="gotoBtn" class="btn btn-outline-primary btn-sm">Ir</button>
          </div>
        </div>
      </div>
    </div>

    <div class="card shadow-sm">
      <div class="card-body">
        <div class="table-responsive">
          <table id="simsTable" class="table table-hover align-middle bg-white">
            <thead class="table-light">
              <tr>
                <th>#</th>
                <th class="sortable" data-col="iccid">ICCID</th>
                <th class="sortable" data-col="msisdn">MSISDN</th>
                <th class="sortable" data-col="sim_id">SIM ID</th>
                <th class="sortable" data-col="country">Pa√≠s</th>
                <th class="sortable" data-col="operator">Operador</th>
                <th class="sortable" data-col="billing_status">Billing Status</th>
                <th class="sortable" data-col="start_fmt">Inicio sesi√≥n datos</th>
                <th class="sortable" data-col="status">Status</th>
                <th class="sortable" data-col="usage">Uso</th>
                <th class="sortable" data-col="updated_at">Actualizado</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
          <div id="emptyMsg" class="text-center text-muted py-3" style="display:none;">Sin resultados.</div>
        </div>
      </div>
    </div>

  </div>

  <script src="/static/js/sims.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
